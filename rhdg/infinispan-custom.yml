infinispan:
  cache-container:
    name: default
    statistics: true
    transport:
      cluster: "${infinispan.cluster.name:cluster}"
      stack: "${infinispan.cluster.stack:tcp}"
      node-name: "${infinispan.node.name:}"
    distributed-cache:
      name: book
      mode: SYNC
      statistics: true
      encoding:
        media-type: application/x-java-serialized-object
  server:
    interfaces:
      interface:
         name: public
         inet-address:
            value: "${infinispan.bind.address:127.0.0.1}"

    socket-bindings:
      default-interface: public
      port-offset: "${infinispan.socket.binding.port-offset:0}"
      socket-binding:
         name: default
         port: "${infinispan.bind.port:11222}"
    security:
      security-realms:
        security-realm:
          name: ldap-realm
          ldap-realm:
            url: ldap://openldap:1389
            # url: ldap://openldap-service.openldap.svc:1389
            principal: "cn=admin,dc=acme,dc=org"
            credential: adminpassword
            direct-verification: true
            identity-mapping:
              rdn-identifier: uid
              search-dn: "ou=clients,dc=acme,dc=org"
              user-password-mapper:
                from: userPassword
                verifiable: false
              attribute-mapping:
                attribute:
                  from: cn
                  to: Roles
                  filter: "(&(objectClass=groupOfNames)(member={1}))"
                  filter-dn: "ou=roles,dc=acme,dc=org"
    endpoints:
      endpoint:
        socket-binding: default
        security-realm: ldap-realm
        hotrod-connector:
          authentication:
            sasl:
              qop: auth
              server-name: infinispan
              mechanisms: BASIC DIGEST PLAIN
        rest-connector:
          authentication:
            mechanisms: DIGEST BASIC
